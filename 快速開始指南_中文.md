# 安全聊天機器人 - 快速開始指南 (中文說明)

## 📖 專案介紹

這是一個使用大型語言模型(LLM)和檢索增強生成(RAG)技術的安全聊天機器人。它可以：
- 自動從NIST資料庫獲取最新CVE漏洞資訊
- 分析你的基礎設施安全風險
- 提供具體的安全建議和補救措施
- 使用自然語言對話介面

## 🚀 Windows 11 安裝步驟

### 步驟 1: 確認Python版本

打開命令提示字元(cmd)或PowerShell，輸入：
```bash
python --version
```
確認版本是 Python 3.13.7 或以上

### 步驟 2: 建立專案資料夾

```bash
cd C:\Users\你的使用者名稱\Documents
mkdir security_chatbot
cd security_chatbot
```

### 步驟 3: 建立虛擬環境

```bash
# 建立虛擬環境
python -m venv venv

# 啟動虛擬環境 (Windows)
venv\Scripts\activate

# 你會看到命令提示字元前面出現 (venv)
```

### 步驟 4: 安裝套件

把專案的所有檔案複製到 `security_chatbot` 資料夾後：

**方案 A: 一鍵自動安裝（推薦）**

```bash
# Windows 用戶 - 雙擊執行或在命令提示字元執行
install.bat

# 腳本會自動：
# 1. 檢查 Python
# 2. 建立虛擬環境
# 3. 安裝所有套件
# 4. 驗證安裝
```

**方案 B: 手動安裝**

```bash
# 啟動虛擬環境（如果還沒有）
venv\Scripts\activate

# 安裝所需套件
pip install -r requirements.txt

# 這會需要幾分鐘，請耐心等待
```

**⚠️ 重要提醒：如果遇到套件安裝錯誤**

如果看到類似 `ERROR: Could not find a version that satisfies the requirement faiss-cpu==1.7.4` 的錯誤：

1. **不要擔心！** 這是 Python 3.13 的已知問題
2. 專案的 requirements.txt 已經更新為相容版本
3. 重新執行 `pip install -r requirements.txt` 應該就能成功

**驗證安裝是否成功：**
```bash
python test_imports.py
```
如果所有套件都顯示 ✅，表示安裝成功！

**如果仍有問題，查看詳細解決方案：**
- 閱讀 `INSTALLATION_FIX.md` 檔案（有完整的解決步驟）
- 或考慮使用 Python 3.11/3.12（更穩定）

### 步驟 5: 設定環境變數

複製 `.env.example` 檔案並改名為 `.env`：

```bash
copy .env.example .env
```

用記事本或任何文字編輯器打開 `.env` 檔案

## 🔑 設定 LLM (選擇其中一種)

### 方案 A: 使用 OpenAI (推薦，但需要付費)

1. **註冊 OpenAI 帳號**
   - 前往 https://platform.openai.com/signup
   - 完成註冊流程

2. **取得 API Key**
   - 登入後前往 https://platform.openai.com/api-keys
   - 點擊 "Create new secret key"
   - 複製產生的 API key (sk-xxx...)

3. **設定 .env 檔案**
   ```env
   OPENAI_API_KEY=sk-你的API金鑰
   USE_OLLAMA=false
   ```

4. **儲值說明**
   - 新用戶通常有 $5 免費額度
   - GPT-3.5-turbo 很便宜：大約 $0.002/1000 tokens
   - 測試專案應該 $1-2 就夠用了

### 方案 B: 使用 Ollama (完全免費，但需要較好的電腦)

1. **下載並安裝 Ollama**
   - 前往 https://ollama.ai
   - 下載 Windows 版本
   - 執行安裝程式

2. **下載 LLM 模型**
   打開新的命令提示字元視窗：
   ```bash
   # 下載 Llama 2 模型 (約 3.8GB，需要一些時間)
   ollama pull llama2
   ```

3. **啟動 Ollama 伺服器**
   在背景保持這個視窗開啟：
   ```bash
   ollama serve
   ```

4. **設定 .env 檔案**
   ```env
   USE_OLLAMA=true
   OLLAMA_MODEL=llama2
   ```

## 🎮 執行程式

### 啟動網頁介面

```bash
# 確保虛擬環境已啟動 (看到 (venv))
# 如果沒有，執行: venv\Scripts\activate

# 執行 Streamlit 應用
streamlit run app.py
```

瀏覽器會自動打開 http://localhost:8501

### 第一次使用

1. **在側邊欄設定**
   - 如果用 OpenAI：輸入 API Key
   - 如果用 Ollama：確保 Ollama 伺服器正在執行

2. **初始化聊天機器人**
   - 點擊 "🚀 Initialize Chatbot" 按鈕
   - 等待系統：
     - 從 NIST 下載 CVE 資料
     - 建立向量資料庫
     - 初始化 LLM

3. **開始對話**
   - 在下方輸入框輸入問題
   - 例如："What are the most critical vulnerabilities?"

## 🧪 執行測試

```bash
# 執行完整測試套件
python test_chatbot.py
```

測試會檢查：
- CVE 資料收集
- RAG 管線
- LLM 整合
- 聊天機器人功能
- 評估指標

## 💡 範例問題（記得用英文問）

試試這些問題：

```
What are the most critical vulnerabilities in our infrastructure?
(我們基礎設施中最嚴重的漏洞是什麼？)

How can we protect our Apache web servers?
(我們應該如何保護 Apache 網頁伺服器？)

Tell me about CVE-2024-1234 and its impact
(告訴我 CVE-2024-1234 及其影響)

What security measures should we implement for Windows servers?
(我們應該為 Windows 伺服器實施哪些安全措施？)

Perform a risk assessment of our database servers
(對我們的資料庫伺服器進行風險評估)
```

## 📁 檔案說明

```
security_chatbot/
├── app.py                  # 網頁介面（Streamlit）
├── chatbot.py             # 聊天機器人主要邏輯
├── rag_pipeline.py        # RAG 實作（FAISS 向量資料庫）
├── cve_collector.py       # CVE 資料收集
├── test_chatbot.py        # 測試腳本
├── requirements.txt       # Python 套件清單
├── .env                   # 你的設定檔（需自己建立）
├── .env.example          # 設定檔範本
├── README.md             # 英文說明文件
├── PRESENTATION_GUIDE.md # 簡報指南
└── 這個檔案.md            # 中文快速開始指南
```

## 🔧 常見問題排除

### 問題 0: 套件安裝失敗（最常見！）
```
錯誤訊息: "ERROR: Could not find a version that satisfies the requirement faiss-cpu==1.7.4"
```
**原因：**
- Python 3.13 與舊版 faiss-cpu 不相容

**解決方法：**
1. **首選方案** - requirements.txt 已更新，重新執行：
   ```bash
   pip install -r requirements.txt
   ```

2. **驗證安裝**：
   ```bash
   python test_imports.py
   ```
   
3. **如果還是失敗** - 查看完整解決方案：
   - 閱讀 `INSTALLATION_FIX.md`
   - 或手動安裝：
     ```bash
     pip install faiss-cpu  # 不指定版本，自動選最新相容版
     pip install streamlit langchain sentence-transformers
     pip install openai requests python-dotenv pandas numpy
     ```

4. **終極方案** - 使用 Python 3.11 或 3.12：
   ```bash
   # 下載 Python 3.11 或 3.12
   # 重新建立虛擬環境
   python3.11 -m venv venv
   venv\Scripts\activate
   pip install -r requirements.txt
   ```

### 問題 1: 無法連接到 Ollama
```
錯誤訊息: "Cannot connect to Ollama"
```
**解決方法：**
- 確認 Ollama 已安裝
- 打開新的命令提示字元執行 `ollama serve`
- 確保沒有防火牆阻擋
- 測試: 在瀏覽器開啟 http://localhost:11434

### 問題 2: OpenAI API 錯誤
```
錯誤訊息: "OpenAI API Error"
```
**解決方法：**
- 檢查 API key 是否正確（在 .env 檔案中）
- 確認有足夠的額度（前往 OpenAI 帳戶查看）
- 檢查網路連線
- API key 不要有多餘的空格或引號

### 問題 3: 無法獲取 CVE 資料
```
錯誤訊息: "No CVEs fetched"
```
**解決方法：**
- 檢查網路連線
- NIST NVD API 可能暫時無法使用，稍後再試
- 嘗試使用較少的天數：修改程式中的 `days=7` 參數

### 問題 4: 找不到模組
```
錯誤訊息: "ModuleNotFoundError: No module named 'xxx'"
```
**解決方法：**
- 確認虛擬環境已啟動（看命令提示字元前面有 (venv)）
- 重新安裝套件：`pip install -r requirements.txt`
- 如果還是有問題，試試：`pip install --upgrade -r requirements.txt`

### 問題 5: Streamlit 無法啟動
```
錯誤訊息: "streamlit: command not found"
```
**解決方法：**
- 確認虛擬環境已啟動
- 重新安裝 Streamlit：`pip install streamlit`
- 試試完整路徑：`python -m streamlit run app.py`

## 📊 系統需求

### 最低需求：
- **CPU**: Intel i5 或同等級
- **RAM**: 8GB
- **硬碟**: 5GB 可用空間
- **網路**: 穩定的網路連線

### 如果使用 Ollama：
- **RAM**: 16GB（推薦）
- **硬碟**: 10GB（模型檔案很大）

## 🎯 專案架構說明

### 工作流程：
```
1. 使用者輸入問題
   ↓
2. 問題轉換成向量（embedding）
   ↓
3. 在 FAISS 向量資料庫中搜尋相關文件
   ↓
4. 取得前 5 個最相關的文件
   ↓
5. 將問題和相關文件一起送給 LLM
   ↓
6. LLM 生成回答
   ↓
7. 顯示回答和來源
```

### 技術棧：
- **Python 3.13.7**: 程式語言
- **Streamlit**: 網頁介面
- **LangChain**: LLM 應用框架
- **FAISS**: 向量資料庫（快速相似度搜尋）
- **sentence-transformers**: 文字轉向量
- **OpenAI/Ollama**: 大型語言模型

## 📚 更新知識庫

### 手動更新 CVE 資料：
1. 在網頁介面側邊欄
2. 點擊 "🔄 Update CVE Database"
3. 等待系統下載最新資料

### 自動更新（進階）：
可以設定 Windows 排程工作每天自動執行：
```bash
python -c "from cve_collector import CVEDataCollector; c = CVEDataCollector(); c.save_to_file(c.fetch_recent_cves())"
```

## 🎓 準備簡報

### 簡報資料位置：
- `PRESENTATION_GUIDE.md` - 完整簡報指南（英文）
- 包含每一頁投影片的內容建議
- 15 分鐘簡報的時間分配

### 展示建議：
1. **準備好範例問題**（3-4個）
2. **截圖重要畫面**：
   - 主介面
   - 對話範例
   - 知識庫資訊
3. **準備架構圖**
4. **錄製操作影片**（當作備案）

## 🤝 取得幫助

### 如果遇到問題：
1. 查看 `README.md` 的 Troubleshooting 章節
2. 執行 `python test_chatbot.py` 看測試結果
3. 檢查錯誤訊息並搜尋解決方法
4. 確認所有套件都正確安裝

### 有用的指令：
```bash
# 查看已安裝的套件
pip list

# 更新所有套件
pip install --upgrade -r requirements.txt

# 清除暫存檔
pip cache purge

# 重新建立虛擬環境（如果環境壞掉）
deactivate
rmdir /s venv
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
```

## ✅ 檢查清單

開始之前確認：
- [ ] Python 3.13.7 已安裝
- [ ] 虛擬環境已建立並啟動
- [ ] 所有套件已安裝（`pip install -r requirements.txt`）
- [ ] .env 檔案已設定
- [ ] LLM 已設定好（OpenAI API key 或 Ollama）
- [ ] 網路連線正常

第一次執行：
- [ ] `streamlit run app.py` 成功啟動
- [ ] 瀏覽器自動開啟 http://localhost:8501
- [ ] 成功初始化聊天機器人
- [ ] 可以正常對話

測試：
- [ ] `python test_chatbot.py` 所有測試通過
- [ ] CVE 資料成功下載
- [ ] 向量資料庫成功建立
- [ ] LLM 回應正常

## 🎉 完成！

如果所有步驟都完成了，你現在應該有一個完整運作的安全聊天機器人！

記得：
- 所有的問題都要用**英文**問
- 介面是**英文**的
- 但我的說明都用**中文**，方便你理解

祝你專案順利！有問題再問我！
